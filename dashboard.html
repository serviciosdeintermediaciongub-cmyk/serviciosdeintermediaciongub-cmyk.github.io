<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUB ‚Äî Mi Inversi√≥n</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy: #0a1628;
            --navy-light: #132041;
            --navy-mid: #0e1a35;
            --green: #2ecc71;
            --green-dark: #1a9c54;
            --blue: #3498db;
            --gold: #d4a843;
            --gold-light: #e8c66a;
            --red: #e74c3c;
            --text-white: #f0f2f5;
            --text-muted: #a0aec0;
            --text-dim: #6b7a90;
            --card-bg: rgba(255,255,255,0.04);
            --card-border: rgba(255,255,255,0.08);
            --glass: rgba(10, 22, 40, 0.92);
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--navy);
            color: var(--text-white);
            min-height: 100vh;
        }

        /* ===== LOGIN ===== */
        .login-screen {
            min-height: 100vh;
            display: flex; align-items: center; justify-content: center;
            background:
                radial-gradient(ellipse at 20% 50%, rgba(46,204,113,0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 20%, rgba(52,152,219,0.04) 0%, transparent 50%),
                var(--navy);
        }
        .login-card {
            background: var(--glass); backdrop-filter: blur(20px);
            border: 1px solid var(--card-border); border-radius: 24px;
            padding: 48px; width: 100%; max-width: 420px; text-align: center;
        }
        .login-logo {
            width: 64px; height: 64px;
            background: linear-gradient(135deg, var(--blue), var(--green));
            border-radius: 16px; display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 1.5rem; color: white; margin: 0 auto 20px;
        }
        .login-card h2 { font-family: 'Playfair Display', serif; font-size: 1.6rem; margin-bottom: 8px; }
        .login-card .sub { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 32px; }
        .form-group { margin-bottom: 18px; text-align: left; }
        .form-group label {
            display: block; font-size: 0.82rem; font-weight: 500; color: var(--text-muted);
            margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;
        }
        .form-group input {
            width: 100%; padding: 12px 16px; background: rgba(255,255,255,0.05);
            border: 1px solid var(--card-border); border-radius: 10px; color: var(--text-white);
            font-size: 0.95rem; font-family: 'DM Sans', sans-serif; outline: none;
        }
        .form-group input:focus { border-color: var(--green); }
        .form-group input::placeholder { color: var(--text-dim); }
        .btn {
            width: 100%; padding: 14px; border: none; border-radius: 10px;
            font-size: 1rem; font-weight: 700; font-family: 'DM Sans', sans-serif;
            cursor: pointer; transition: transform 0.3s, box-shadow 0.3s;
        }
        .btn-green { background: linear-gradient(135deg, var(--green), var(--green-dark)); color: white; }
        .btn-green:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(46,204,113,0.3); }
        .error-msg {
            background: rgba(231,76,60,0.1); border: 1px solid rgba(231,76,60,0.3);
            color: var(--red); padding: 10px; border-radius: 8px;
            font-size: 0.85rem; margin-bottom: 16px; display: none;
        }
        .login-footer {
            margin-top: 24px; font-size: 0.85rem; color: var(--text-dim);
        }
        .login-footer a { color: var(--green); text-decoration: none; }

        /* ===== LOADING ===== */
        .loading-screen {
            display: none; min-height: 100vh;
            align-items: center; justify-content: center;
            background: var(--navy);
        }
        .loading-screen.active { display: flex; }
        .spinner {
            width: 48px; height: 48px;
            border: 4px solid var(--card-border);
            border-top: 4px solid var(--green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ===== CLIENT DASHBOARD ===== */
        .dashboard { display: none; }
        .dash-header {
            background: var(--glass); backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--card-border);
            padding: 16px 32px;
            display: flex; align-items: center; justify-content: space-between;
            position: sticky; top: 0; z-index: 100;
        }
        .dash-header-left { display: flex; align-items: center; gap: 12px; }
        .dash-logo {
            width: 40px; height: 40px;
            background: linear-gradient(135deg, var(--blue), var(--green));
            border-radius: 10px; display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 1rem; color: white;
        }
        .dash-header h1 { font-family: 'Playfair Display', serif; font-size: 1.3rem; }
        .dash-header h1 span {
            display: block; font-size: 0.7rem; font-family: 'DM Sans', sans-serif;
            color: var(--text-muted); font-weight: 400;
        }
        .dash-user {
            display: flex; align-items: center; gap: 14px;
        }
        .dash-user-avatar {
            width: 40px; height: 40px; border-radius: 50%;
            background: linear-gradient(135deg, var(--green), var(--blue));
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 0.9rem; color: white;
        }
        .dash-user-name { font-weight: 600; font-size: 0.9rem; }
        .dash-user-email { font-size: 0.75rem; color: var(--text-dim); }
        .btn-logout {
            background: rgba(231,76,60,0.1); border: 1px solid rgba(231,76,60,0.2);
            color: var(--red); padding: 8px 20px; border-radius: 8px;
            font-size: 0.85rem; font-weight: 600; cursor: pointer;
            font-family: 'DM Sans', sans-serif; margin-left: 16px;
        }

        .dash-body { padding: 32px; max-width: 1100px; margin: 0 auto; }

        /* Welcome banner */
        .welcome-banner {
            background: linear-gradient(135deg, rgba(46,204,113,0.1), rgba(52,152,219,0.08));
            border: 1px solid rgba(46,204,113,0.15);
            border-radius: 20px; padding: 36px 40px; margin-bottom: 32px;
            position: relative; overflow: hidden;
        }
        .welcome-banner::before {
            content: ''; position: absolute; top: -50%; right: -20%;
            width: 400px; height: 400px;
            background: radial-gradient(circle, rgba(46,204,113,0.08), transparent 70%);
            border-radius: 50%;
        }
        .welcome-banner h2 {
            font-family: 'Playfair Display', serif; font-size: 1.8rem;
            margin-bottom: 8px; position: relative;
        }
        .welcome-banner p { color: var(--text-muted); font-size: 1rem; position: relative; }

        /* Main stat cards */
        .main-stats {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; margin-bottom: 32px;
        }
        .main-stat-card {
            background: var(--card-bg); border: 1px solid var(--card-border);
            border-radius: 18px; padding: 32px; position: relative; overflow: hidden;
        }
        .main-stat-card::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0;
            height: 3px; border-radius: 3px 3px 0 0;
        }
        .main-stat-card:nth-child(1)::after { background: linear-gradient(90deg, var(--blue), var(--blue)); }
        .main-stat-card:nth-child(2)::after { background: linear-gradient(90deg, var(--gold), var(--gold-light)); }
        .main-stat-card:nth-child(3)::after { background: linear-gradient(90deg, var(--green), var(--green-dark)); }
        .main-stat-icon {
            font-size: 2rem; margin-bottom: 16px;
        }
        .main-stat-label {
            font-size: 0.78rem; color: var(--text-dim); text-transform: uppercase;
            letter-spacing: 1px; margin-bottom: 10px;
        }
        .main-stat-value {
            font-family: 'Playfair Display', serif; font-size: 2.4rem; font-weight: 700;
        }
        .main-stat-value.blue { color: var(--blue); }
        .main-stat-value.gold { color: var(--gold); }
        .main-stat-value.green { color: var(--green); }

        /* Detail cards row */
        .detail-row {
            display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px;
        }
        .detail-card {
            background: var(--card-bg); border: 1px solid var(--card-border);
            border-radius: 18px; padding: 32px;
        }
        .detail-card h3 {
            font-family: 'Playfair Display', serif; font-size: 1.2rem;
            margin-bottom: 24px; display: flex; align-items: center; gap: 10px;
        }
        .detail-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px 0; border-bottom: 1px solid var(--card-border);
        }
        .detail-item:last-child { border-bottom: none; }
        .detail-item .label { font-size: 0.88rem; color: var(--text-dim); }
        .detail-item .value { font-weight: 600; font-size: 0.95rem; }
        .detail-item .value.green { color: var(--green); }
        .detail-item .value.gold { color: var(--gold); }
        .detail-item .value.blue { color: var(--blue); }

        /* Progress bar */
        .progress-section { margin-bottom: 32px; }
        .progress-card {
            background: var(--card-bg); border: 1px solid var(--card-border);
            border-radius: 18px; padding: 32px;
        }
        .progress-card h3 {
            font-family: 'Playfair Display', serif; font-size: 1.2rem;
            margin-bottom: 20px; display: flex; align-items: center; gap: 10px;
        }
        .progress-bar-container {
            background: rgba(255,255,255,0.06); border-radius: 12px;
            height: 24px; overflow: hidden; margin-bottom: 12px; position: relative;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--green), var(--blue));
            border-radius: 12px;
            transition: width 1.5s ease;
            display: flex; align-items: center; justify-content: flex-end; padding-right: 10px;
            font-size: 0.75rem; font-weight: 700; color: white;
            min-width: 40px;
        }
        .progress-labels {
            display: flex; justify-content: space-between;
            font-size: 0.8rem; color: var(--text-dim);
        }

        /* WhatsApp contact */
        .contact-card {
            background: linear-gradient(135deg, rgba(37,211,102,0.08), rgba(37,211,102,0.03));
            border: 1px solid rgba(37,211,102,0.15);
            border-radius: 18px; padding: 32px;
            display: flex; align-items: center; justify-content: space-between;
            flex-wrap: wrap; gap: 16px;
        }
        .contact-card h3 { font-size: 1.1rem; font-weight: 600; }
        .contact-card p { font-size: 0.9rem; color: var(--text-muted); }
        .btn-whatsapp {
            display: inline-flex; align-items: center; gap: 10px;
            background: #25D366; color: white; padding: 14px 28px;
            border-radius: 12px; text-decoration: none; font-weight: 700;
            font-size: 0.95rem; transition: transform 0.3s, box-shadow 0.3s;
        }
        .btn-whatsapp:hover {
            transform: translateY(-2px); box-shadow: 0 8px 25px rgba(37,211,102,0.3);
        }
        .btn-whatsapp svg { width: 1.2em; height: 1.2em; fill: white; }

        /* Footer */
        .dash-footer {
            text-align: center; padding: 32px; font-size: 0.78rem; color: var(--text-dim);
            border-top: 1px solid var(--card-border); margin-top: 40px;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .main-stats { grid-template-columns: 1fr; }
            .detail-row { grid-template-columns: 1fr; }
            .dash-body { padding: 20px; }
            .dash-header { padding: 12px 16px; flex-wrap: wrap; gap: 12px; }
            .welcome-banner { padding: 28px 24px; }
            .welcome-banner h2 { font-size: 1.4rem; }
            .main-stat-value { font-size: 1.8rem; }
            .contact-card { flex-direction: column; text-align: center; }
            .dash-user-name, .dash-user-email { display: none; }
        }
        @media (max-width: 480px) {
            .login-card { padding: 32px 24px; }
        }
    </style>
</head>
<body>

<!-- ===== LOGIN ===== -->
<div class="login-screen" id="loginScreen">
    <div class="login-card">
        <div class="login-logo">GUB</div>
        <h2>Portal del Inversionista</h2>
        <p class="sub">Accede a tu cuenta para ver tu inversi√≥n</p>
        <div class="error-msg" id="loginError"></div>
        <form id="loginForm">
            <div class="form-group">
                <label>Correo electr√≥nico</label>
                <input type="email" id="loginEmail" placeholder="tu@email.com" required>
            </div>
            <div class="form-group">
                <label>Contrase√±a</label>
                <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
            </div>
            <button type="submit" class="btn btn-green" id="loginBtn">Ingresar a mi cuenta</button>
        </form>
        <div class="login-footer">
            ¬øA√∫n no tienes cuenta? <a href="index.html">Solicita informaci√≥n aqu√≠</a>
        </div>
    </div>
</div>

<!-- ===== LOADING ===== -->
<div class="loading-screen" id="loadingScreen">
    <div class="spinner"></div>
</div>

<!-- ===== DASHBOARD ===== -->
<div class="dashboard" id="dashboard">
    <header class="dash-header">
        <div class="dash-header-left">
            <div class="dash-logo">GUB</div>
            <h1>Mi Inversi√≥n<span>Portal del Inversionista</span></h1>
        </div>
        <div class="dash-user">
            <div class="dash-user-avatar" id="userAvatar">--</div>
            <div>
                <div class="dash-user-name" id="userName">‚Äî</div>
                <div class="dash-user-email" id="userEmail">‚Äî</div>
            </div>
            <button class="btn-logout" onclick="logout()">Salir</button>
        </div>
    </header>

    <div class="dash-body">
        <!-- Welcome -->
        <div class="welcome-banner">
            <h2 id="welcomeMsg">Bienvenido, Inversionista</h2>
            <p>Aqu√≠ puedes consultar el estado actual de tu inversi√≥n y rendimientos con GUB.</p>
        </div>

        <!-- Main Stats -->
        <div class="main-stats">
            <div class="main-stat-card">
                <div class="main-stat-icon">üí∞</div>
                <div class="main-stat-label">Capital invertido</div>
                <div class="main-stat-value blue" id="dCapital">$0</div>
            </div>
            <div class="main-stat-card">
                <div class="main-stat-icon">üìà</div>
                <div class="main-stat-label">Rendimiento acumulado</div>
                <div class="main-stat-value gold" id="dProfit">$0</div>
            </div>
            <div class="main-stat-card">
                <div class="main-stat-icon">üè¶</div>
                <div class="main-stat-label">Saldo total actual</div>
                <div class="main-stat-value green" id="dTotal">$0</div>
            </div>
        </div>

        <!-- Progress -->
        <div class="progress-section">
            <div class="progress-card">
                <h3>‚è≥ Progreso de tu inversi√≥n</h3>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%;">0%</div>
                </div>
                <div class="progress-labels">
                    <span id="progressStart">Inicio</span>
                    <span id="progressEnd">Vencimiento</span>
                </div>
            </div>
        </div>

        <!-- Details -->
        <div class="detail-row">
            <div class="detail-card">
                <h3>üìã Detalle de inversi√≥n</h3>
                <div class="detail-item">
                    <span class="label">Tasa de inter√©s compuesto mensual</span>
                    <span class="value green">4%</span>
                </div>
                <div class="detail-item">
                    <span class="label">Plazo de inversi√≥n</span>
                    <span class="value" id="dTerm">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Fecha de inicio</span>
                    <span class="value" id="dStartDate">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Fecha de vencimiento</span>
                    <span class="value" id="dEndDate">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Estado</span>
                    <span class="value green" id="dStatus">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Perfil de inversor</span>
                    <span class="value" id="dProfile" style="text-transform:capitalize;">‚Äî</span>
                </div>
            </div>
            <div class="detail-card">
                <h3>üë§ Datos personales</h3>
                <div class="detail-item">
                    <span class="label">Nombre completo</span>
                    <span class="value" id="dName">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Correo electr√≥nico</span>
                    <span class="value" id="dEmail">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Tel√©fono</span>
                    <span class="value" id="dPhone">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Pa√≠s</span>
                    <span class="value" id="dCountry">‚Äî</span>
                </div>
            </div>
        </div>

        <!-- Exchange Rate Protection -->
        <div class="progress-section">
            <div class="progress-card" style="border: 1px solid rgba(46,204,113,0.15); background: linear-gradient(135deg, rgba(46,204,113,0.04), rgba(52,152,219,0.03));">
                <h3>üõ°Ô∏è Protecci√≥n Cambiaria</h3>
                <p style="font-size:0.88rem;color:var(--text-muted);margin-bottom:20px;">Tu inversi√≥n est√° protegida contra la baja del d√≥lar. Si el tipo de cambio baja, se te respeta el valor original.</p>
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;">
                    <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:20px;text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Tipo de cambio fijado</div>
                        <div style="font-family:'Playfair Display',serif;font-size:1.6rem;font-weight:700;color:var(--blue);" id="dExchangeFixed">‚Äî</div>
                        <div style="font-size:0.75rem;color:var(--text-dim);margin-top:4px;">MXN por d√≥lar</div>
                    </div>
                    <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:20px;text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Tipo de cambio actual</div>
                        <div style="font-family:'Playfair Display',serif;font-size:1.6rem;font-weight:700;color:var(--text-muted);" id="dExchangeCurrent">‚Äî</div>
                        <div style="font-size:0.75rem;color:var(--text-dim);margin-top:4px;">MXN por d√≥lar</div>
                    </div>
                    <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:20px;text-align:center;">
                        <div style="font-size:0.75rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Tipo de cambio aplicado</div>
                        <div style="font-family:'Playfair Display',serif;font-size:1.6rem;font-weight:700;color:var(--green);" id="dExchangeApplied">‚Äî</div>
                        <div style="font-size:0.75rem;color:var(--text-dim);margin-top:4px;">MXN por d√≥lar</div>
                    </div>
                </div>
                <div style="margin-top:18px;display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,0.03);border-radius:10px;padding:14px 20px;flex-wrap:wrap;gap:10px;">
                    <div>
                        <span style="font-size:0.85rem;color:var(--text-dim);">Tu inversi√≥n en pesos mexicanos:</span>
                    </div>
                    <div style="font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;color:var(--gold);" id="dTotalMXN">‚Äî</div>
                </div>
            </div>
        </div>

        <!-- Projected -->
        <div class="detail-row">
            <div class="detail-card">
                <h3>üéØ Proyecci√≥n estimada</h3>
                <div class="detail-item">
                    <span class="label">Rendimiento proyectado al vencimiento</span>
                    <span class="value gold" id="dProjectedProfit">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Saldo final proyectado</span>
                    <span class="value green" id="dProjectedTotal">‚Äî</span>
                </div>
                <div class="detail-item">
                    <span class="label">Rendimiento mensual estimado</span>
                    <span class="value blue" id="dMonthlyReturn">‚Äî</span>
                </div>
            </div>
            <div class="detail-card" style="display:flex;flex-direction:column;justify-content:center;">
                <div class="contact-card" style="border:none;padding:0;background:none;">
                    <div>
                        <h3>¬øTienes dudas sobre tu inversi√≥n?</h3>
                        <p>Contacta a tu asesor directamente por WhatsApp</p>
                    </div>
                    <a href="https://wa.me/5215555052715?text=Hola%2C%20soy%20cliente%20de%20GUB%20y%20tengo%20una%20consulta%20sobre%20mi%20inversi%C3%B3n" class="btn-whatsapp" target="_blank">
                        <svg viewBox="0 0 448 512"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.8-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
                        Hablar por WhatsApp
                    </a>
                </div>
            </div>
        </div>

        <!-- CUENTA CORPORATIVA AUTORIZADA -->
        <div style="margin-bottom:32px;">
            <div style="background:linear-gradient(135deg, rgba(212,168,67,0.06), rgba(52,152,219,0.04));border:1px solid rgba(212,168,67,0.18);border-radius:20px;padding:36px;position:relative;overflow:hidden;">
                <div style="position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg, var(--gold), var(--blue));"></div>
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:24px;">
                    <div style="font-size:1.8rem;">üè¶</div>
                    <div>
                        <h3 style="font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;color:var(--gold);">Cuenta Corporativa Autorizada</h3>
                        <p style="font-size:0.8rem;color:var(--text-dim);">Realiza tus dep√≥sitos exclusivamente a esta cuenta v√≠a SPEI</p>
                    </div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                    <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:18px;">
                        <div style="font-size:0.72rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;">Banco</div>
                        <div style="font-weight:700;font-size:1.05rem;color:var(--text-white);">BBVA Bancomer</div>
                    </div>
                    <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:18px;">
                        <div style="font-size:0.72rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;">Titular</div>
                        <div style="font-weight:700;font-size:1.05rem;color:var(--text-white);">Servicios de Intermediaci√≥n GUB</div>
                    </div>
                </div>
                <div style="background:rgba(255,255,255,0.04);border-radius:12px;padding:18px;margin-top:16px;">
                    <div style="font-size:0.72rem;color:var(--text-dim);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;">CLABE Interbancaria (SPEI)</div>
                    <div style="font-family:monospace;font-weight:700;font-size:1.3rem;color:var(--blue);letter-spacing:2px;">012 180 0012 0494 5344</div>
                </div>
                <div style="margin-top:20px;background:rgba(231,76,60,0.06);border:1px solid rgba(231,76,60,0.12);border-radius:12px;padding:16px;display:flex;align-items:flex-start;gap:10px;">
                    <div style="font-size:1.2rem;">‚ö†Ô∏è</div>
                    <div>
                        <div style="font-size:0.85rem;font-weight:700;color:var(--red);margin-bottom:4px;">Aviso de seguridad</div>
                        <div style="font-size:0.82rem;color:var(--text-muted);line-height:1.6;">Realiza tus dep√≥sitos <strong style="color:var(--text-white);">√∫nicamente v√≠a SPEI</strong> a esta cuenta corporativa. GUB Partners nunca te solicitar√° dep√≥sitos en efectivo, transferencias a cuentas personales ni pagos por otros medios. Si alguien te pide lo contrario, rep√≥rtalo de inmediato.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- INSTITUCIONES REGULADORAS -->
        <div style="background:var(--card-bg);border:1px solid var(--card-border);border-radius:20px;padding:36px;text-align:center;margin-bottom:32px;">
            <div style="font-size:0.75rem;font-weight:600;color:var(--green);text-transform:uppercase;letter-spacing:2px;margin-bottom:12px;">Respaldo institucional</div>
            <h3 style="font-family:'Playfair Display',serif;font-size:1.2rem;font-weight:700;margin-bottom:28px;">Regulados por las principales instituciones de M√©xico</h3>
            <div style="display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:40px;">
                <div style="text-align:center;">
                    <img src="logo-hacienda.png" alt="Secretar√≠a de Hacienda y Cr√©dito P√∫blico" style="height:55px;object-fit:contain;filter:brightness(0) invert(1);opacity:0.8;margin-bottom:6px;">
                    <div style="font-size:0.65rem;color:var(--text-dim);">Secretar√≠a de Hacienda<br>y Cr√©dito P√∫blico</div>
                </div>
                <div style="width:1px;height:45px;background:var(--card-border);"></div>
                <div style="text-align:center;">
                    <img src="logo-banxico.png" alt="Banco de M√©xico" style="height:55px;object-fit:contain;filter:brightness(0) invert(1);opacity:0.8;margin-bottom:6px;">
                    <div style="font-size:0.65rem;color:var(--text-dim);">Banco de M√©xico</div>
                </div>
                <div style="width:1px;height:45px;background:var(--card-border);"></div>
                <div style="text-align:center;">
                    <img src="logo-bmv.png" alt="Bolsa Mexicana de Valores" style="height:55px;object-fit:contain;filter:brightness(0) invert(1);opacity:0.8;margin-bottom:6px;">
                    <div style="font-size:0.65rem;color:var(--text-dim);">Bolsa Mexicana<br>de Valores</div>
                </div>
                <div style="width:1px;height:45px;background:var(--card-border);"></div>
                <div style="text-align:center;">
                    <img src="logo-cnbv.png" alt="CNBV" style="height:55px;object-fit:contain;filter:brightness(0) invert(1);opacity:0.8;margin-bottom:6px;">
                    <div style="font-size:0.65rem;color:var(--text-dim);">Comisi√≥n Nacional Bancaria<br>y de Valores</div>
                </div>
            </div>
        </div>
    </div>

    <div class="dash-footer">
        Las inversiones implican riesgos. Los rendimientos pasados no garantizan resultados futuros. En GUB trabajamos con un modelo de riesgo controlado.<br>
        ¬© 2021 GUB Servicios de Intermediaci√≥n. Todos los derechos reservados.
    </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyACvJJ62Pp-8cxCqIPJLsGteT8iHXutuo8",
        authDomain: "gub-inversiones.firebaseapp.com",
        projectId: "gub-inversiones",
        storageBucket: "gub-inversiones.firebasestorage.app",
        messagingSenderId: "587532880342",
        appId: "1:587532880342:web:435d56610e0d36efcdbc77"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const COUNTRIES = { MX:'M√©xico', US:'Estados Unidos', CO:'Colombia', AR:'Argentina', CL:'Chile', PE:'Per√∫', ES:'Espa√±a', OTHER:'Otro' };

    // Auth state
    auth.onAuthStateChanged(async (user) => {
        if (user) {
            showLoading();
            try {
                const doc = await db.collection('clients').doc(user.uid).get();
                if (doc.exists) {
                    loadDashboard(user, doc.data());
                } else {
                    document.getElementById('loginError').textContent = 'No se encontr√≥ tu perfil de inversi√≥n. Contacta a tu asesor.';
                    document.getElementById('loginError').style.display = 'block';
                    auth.signOut();
                    showLogin();
                }
            } catch (err) {
                console.error(err);
                showLogin();
            }
        } else {
            showLogin();
        }
    });

    // Login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = document.getElementById('loginBtn');
        const error = document.getElementById('loginError');
        btn.textContent = 'Ingresando...';
        btn.disabled = true;
        error.style.display = 'none';

        try {
            await auth.signInWithEmailAndPassword(
                document.getElementById('loginEmail').value,
                document.getElementById('loginPassword').value
            );
        } catch (err) {
            error.textContent = 'Correo o contrase√±a incorrectos.';
            error.style.display = 'block';
            btn.textContent = 'Ingresar a mi cuenta';
            btn.disabled = false;
        }
    });

    function showLogin() {
        document.getElementById('loginScreen').style.display = 'flex';
        document.getElementById('loadingScreen').classList.remove('active');
        document.getElementById('dashboard').style.display = 'none';
    }
    function showLoading() {
        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('loadingScreen').classList.add('active');
        document.getElementById('dashboard').style.display = 'none';
    }
    function logout() { auth.signOut(); }

    function fmt(n) { return '$' + Number(n).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + ' d√≥lares'; }

    async function loadDashboard(user, data) {
        document.getElementById('loadingScreen').classList.remove('active');
        document.getElementById('dashboard').style.display = 'block';

        const name = `${data.firstName} ${data.lastName}`;
        const initials = (data.firstName[0] + data.lastName[0]).toUpperCase();
        const capital = Number(data.capital) || 0;
        const profit = Number(data.profit) || 0;
        const total = capital + profit;
        const term = parseInt(data.term) || 12;
        const rate = 0.04; // 4% monthly compound

        // Header
        document.getElementById('userAvatar').textContent = initials;
        document.getElementById('userName').textContent = name;
        document.getElementById('userEmail').textContent = user.email;

        // Welcome
        document.getElementById('welcomeMsg').textContent = `Bienvenido, ${data.firstName}`;

        // Main stats
        document.getElementById('dCapital').textContent = fmt(capital);
        document.getElementById('dProfit').textContent = fmt(profit);
        document.getElementById('dTotal').textContent = fmt(total);

        // Investment details
        document.getElementById('dTerm').textContent = `${term} meses`;
        document.getElementById('dStartDate').textContent = data.startDate || '‚Äî';
        document.getElementById('dStatus').textContent = data.status === 'active' ? '‚úÖ Activo' : '‚è∏Ô∏è Inactivo';
        
        // Investor profile
        const profileLabels = { conservador: 'üü¢ Conservador', moderado: 'üü° Moderado', arriesgado: 'üî¥ Arriesgado' };
        document.getElementById('dProfile').textContent = profileLabels[data.investorProfile] || data.investorProfile || '‚Äî';

        // Calculate end date
        if (data.startDate) {
            const start = new Date(data.startDate);
            const end = new Date(start);
            end.setMonth(end.getMonth() + term);
            document.getElementById('dEndDate').textContent = end.toISOString().split('T')[0];

            // Progress bar
            const now = new Date();
            const totalDays = (end - start) / (1000 * 60 * 60 * 24);
            const elapsedDays = Math.max(0, (now - start) / (1000 * 60 * 60 * 24));
            const pct = Math.min(100, Math.round((elapsedDays / totalDays) * 100));
            document.getElementById('progressBar').style.width = pct + '%';
            document.getElementById('progressBar').textContent = pct + '%';
            document.getElementById('progressStart').textContent = data.startDate;
            document.getElementById('progressEnd').textContent = end.toISOString().split('T')[0];
        }

        // Personal data
        document.getElementById('dName').textContent = name;
        document.getElementById('dEmail').textContent = user.email;
        document.getElementById('dPhone').textContent = data.phone || '‚Äî';
        document.getElementById('dCountry').textContent = COUNTRIES[data.country] || data.country || '‚Äî';

        // Projections ‚Äî Compound interest: A = P √ó (1 + r)^n
        const monthlyRate = 0.04;
        const projectedTotal = capital * Math.pow(1 + monthlyRate, term);
        const projectedProfit = projectedTotal - capital;
        const monthlyReturn = projectedProfit / term;
        document.getElementById('dProjectedProfit').textContent = fmt(Math.round(projectedProfit));
        document.getElementById('dProjectedTotal').textContent = fmt(Math.round(projectedTotal));
        document.getElementById('dMonthlyReturn').textContent = fmt(Math.round(monthlyReturn));

        // Exchange rate protection
        const fixedRate = Number(data.exchangeRate) || 0;
        if (fixedRate > 0) {
            document.getElementById('dExchangeFixed').textContent = '$' + fixedRate.toFixed(2);
            
            // Fetch current exchange rate
            try {
                const response = await fetch('https://open.er-api.com/v6/latest/USD');
                const rateData = await response.json();
                if (rateData && rateData.rates && rateData.rates.MXN) {
                    const currentRate = rateData.rates.MXN;
                    document.getElementById('dExchangeCurrent').textContent = '$' + currentRate.toFixed(2);
                    
                    // Protection logic: if current < fixed, use fixed (protect); if current > fixed, use current (benefit)
                    const appliedRate = Math.max(fixedRate, currentRate);
                    document.getElementById('dExchangeApplied').textContent = '$' + appliedRate.toFixed(2);
                    
                    // Show status indicator
                    if (currentRate < fixedRate) {
                        document.getElementById('dExchangeApplied').style.color = 'var(--green)';
                        document.getElementById('dExchangeCurrent').style.color = 'var(--red)';
                    } else {
                        document.getElementById('dExchangeApplied').style.color = 'var(--green)';
                        document.getElementById('dExchangeCurrent').style.color = 'var(--green)';
                    }
                    
                    // Total in MXN
                    const totalMXN = total * appliedRate;
                    document.getElementById('dTotalMXN').textContent = '$' + Math.round(totalMXN).toLocaleString('en-US') + ' MXN';
                }
            } catch (err) {
                console.error('Error fetching exchange rate:', err);
                document.getElementById('dExchangeCurrent').textContent = 'No disponible';
                document.getElementById('dExchangeApplied').textContent = '$' + fixedRate.toFixed(2);
                const totalMXN = total * fixedRate;
                document.getElementById('dTotalMXN').textContent = '$' + Math.round(totalMXN).toLocaleString('en-US') + ' MXN';
            }
        } else {
            document.getElementById('dExchangeFixed').textContent = 'No registrado';
            document.getElementById('dExchangeCurrent').textContent = '‚Äî';
            document.getElementById('dExchangeApplied').textContent = '‚Äî';
            document.getElementById('dTotalMXN').textContent = '‚Äî';
        }
    }
</script>
</body>
</html>
